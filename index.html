<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ASEAN UNION</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <script src="https://unpkg.com/htmx.org@1.9.2"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.8.1/dist/ethers.min.js"></script>
</head>
<body class="bg-light">

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary px-3">
    <a class="navbar-brand" href="#">üåè ASEAN UNION</a>
    <div class="ms-auto">
      <button class="btn btn-outline-light" onclick="connectWallet()">Connect Wallet</button>
      <span id="walletAddress" class="text-white ms-2"></span>
    </div>
  </nav>

  <!-- Tabs -->
  <div class="container mt-4">
    <ul class="nav nav-tabs">
      <li class="nav-item"><a class="nav-link active" hx-get="modules/citizen.html" hx-target="#tabContent" hx-trigger="load" href="#">JOIN</a></li>
      <li class="nav-item"><a class="nav-link" hx-get="modules/country.html" hx-target="#tabContent" href="#">Countries</a></li>
      <li class="nav-item"><a class="nav-link" hx-get="modules/governance.html" hx-target="#tabContent" href="#">Governance</a></li>
      <li class="nav-item"><a class="nav-link" hx-get="modules/funding.html" hx-target="#tabContent" href="#">Funding</a></li>
      <li class="nav-item"><a class="nav-link" hx-get="modules/migration.html" hx-target="#tabContent" href="#">Migration</a></li>
      <li class="nav-item"><a class="nav-link" hx-get="modules/marketplace.html" hx-target="#tabContent" href="#">Marketplace</a></li>
      <li class="nav-item"><a class="nav-link" hx-get="modules/election.html" hx-target="#tabContent" href="#">Election</a></li>
      <li class="nav-item"><a class="nav-link" hx-get="modules/documents.html" hx-target="#tabContent" href="#">Documents</a></li>
      <li class="nav-item"><a class="nav-link" hx-get="modules/supplychain.html" hx-target="#tabContent" href="#">Shipping</a></li>
    </ul>

    <div id="tabContent" class="mt-4">
      <!-- Content loaded via HTMX -->
    </div>
  </div>

  <!-- Web3 Script -->
  <script>
    async function connectWallet() {
      if (typeof window.ethereum !== 'undefined') {
        try {
          const provider = new ethers.BrowserProvider(window.ethereum);
          const signer = await provider.getSigner();
          const address = await signer.getAddress();
          document.getElementById('walletAddress').innerText = shortenAddress(address);
        } catch (err) {
          console.error('Wallet connection failed:', err);
          alert('ü¶ä Please approve wallet connection in MetaMask.');
        }
      } else {
        alert('ü¶ä MetaMask not found. Please install it.');
      }
    }

    function shortenAddress(address) {
      return address.slice(0, 6) + '...' + address.slice(-4);
    }

    window.addEventListener('DOMContentLoaded', async () => {
      if (window.ethereum && window.ethereum.selectedAddress) {
        connectWallet();
      }
    });
  </script>
</body>
</html>
