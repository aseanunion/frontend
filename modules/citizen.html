<div class="card">
  <div class="card-body">
    <h4 class="card-title">Join ASEAN UNION 🌐</h4>
    <p>Register as a citizen by completing KYC and minting your CitizenNFT.</p>

    <button class="btn btn-success" onclick="joinASEAN()">🚀 Start KYC & Mint NFT</button>
    <div id="joinStatus" class="mt-3 text-muted"></div>
  </div>
</div>

<script>
async function joinASEAN() {
  document.getElementById("joinStatus").innerText = "🔍 Verifying KYC...";
  const kycResponse = await fetch("https://your-kyc-api.com/verify", {
    method: "POST",
    body: JSON.stringify({ address: userAddress }),
    headers: { "Content-Type": "application/json" }
  });
  const kycData = await kycResponse.json();

  if (!kycData.verified) {
    document.getElementById("joinStatus").innerText = "❌ KYC Failed.";
    return;
  }

  const abi = [
    "function mint(address to, string memory metadataURI) public"
  ];
  const citizen = new ethers.Contract(citizenNFTAddress, abi, signer);
  const tx = await citizen.mint(userAddress, kycData.metadataURI);
  await tx.wait();
  document.getElementById("joinStatus").innerText = "✅ Welcome, Citizen!";
}
</script>
